### 原始流程
先验城市分析 =》 后验城市选择

问题1. 先验和后验两部分均基于规则，效果不好并且可维护性差。
问题2. 原始的城市分析仅用query级的特征，包括点击，session改写，query和城市共现，对于低频query处理的不好


### 新的流程
1. 城市分析是一个轻召回重排序的问题，我们将城市分析设计为召回和排序的两阶段任务
2. 召回阶段，我们主要从query和phrase两种粒度挖掘特征资源，而后进行候选城市归并。
3.排序阶段，需要对候选城市进行判断，识别是否应为目标城市，用gbdt进行二分类进行拟合

### 样本构建
样本方面，我们选择从搜索日志中随机抽取，简单清洗后，进行人工标注。构造样本时存在本异地分样本分布不均的问题，本地需求远远多于异地，这里需要剔除本地和异地相关的特征，避免模型学偏。


### 特征体系

query级特征：如用户在特定query&city下的点击；
phrase级特征：类比于query级的特征，在更细粒度下进行统计；
组合特征：为了克服单一特征表征能力不足的问题，这里我们进行了一些人工特征组合。
